<html><head><title>Wrapping function for visualization of gene expression values of time course experiments</title>
<link rel="stylesheet" type="text/css" href="Rchm.css">
</head>
<body>

<table width="100%"><tr><td>see.genes(maSigPro)</td><td align="right">R Documentation</td></tr></table><object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="keyword" value="R:   see.genes">
<param name="keyword" value=" Wrapping function for visualization of gene expression values of time course experiments">
</object>


<h2>Wrapping function for visualization of gene expression values of time course experiments</h2>


<h3>Description</h3>

<p>
This function provides visualisation tools for gene expression values in a time course 
experiment. The function first calls the heatmap function for a general overview of 
experiment results. Next a partioning of the data is generated using a clustering method.
The results of the clustering are visualized both as gene expression profiles extended along all
arrays in the experiment, as provided by the plot.profiles function, and as summary expression 
profiles for  comparison among experimental groups.
</p>


<h3>Usage</h3>

<pre>
see.genes(data, edesign = data$edesign, time.col = 1, repl.col = 2, group.cols = 
          c(3:ncol(edesign)), names.groups = colnames(edesign)[3:ncol(edesign)], 
          cluster.data = 1, groups.vector = data$groups.vector, k = 9, 
          cluster.method = "kmeans", distance = "cor", agglo.method = "complete", 
          show.fit = FALSE, dis = NULL, step.method = "backward", min.obs = 3, 
          alfa = 0.01, show.lines = TRUE, iter.max = 500, cexlab = 1, legend = TRUE, 
          newX11 = TRUE, ylim = NULL, main = NULL, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>data</code></td>
<td>
either matrix or a list containing the gene expression data, typically a <code><a href="get.siggenes.html">get.siggenes</a></code> object</td></tr>
<tr valign="top"><td><code>edesign</code></td>
<td>
matrix of experimental design </td></tr>
<tr valign="top"><td><code>time.col</code></td>
<td>
column in edesign containing time values. Default is first column</td></tr>
<tr valign="top"><td><code>repl.col</code></td>
<td>
column in edesign containing coding for replicates arrays. Default is second column
</td></tr>
<tr valign="top"><td><code>group.cols</code></td>
<td>
columns indicating the coding for each group (treatment, tissue,...) in the experiment (see details)
</td></tr>
<tr valign="top"><td><code>names.groups</code></td>
<td>
names for experimental groups</td></tr>
<tr valign="top"><td><code>cluster.data</code></td>
<td>
type of data used by the cluster algorithm (see details) </td></tr>
<tr valign="top"><td><code>groups.vector</code></td>
<td>
Vector indicating the experimental group to which each variable belongs  </td></tr>
<tr valign="top"><td><code>k</code></td>
<td>
number of clusters for data partioning</td></tr>
<tr valign="top"><td><code>cluster.method</code></td>
<td>
clustering method for data partioning </td></tr>
<tr valign="top"><td><code>distance</code></td>
<td>
distance measurement function for when <code>cluster.method</code> is <code>"hclust"</code> </td></tr>
<tr valign="top"><td><code>agglo.method</code></td>
<td>
aggregation method used when <code>cluster.method</code> is "hclust" </td></tr>
<tr valign="top"><td><code>show.fit</code></td>
<td>
logical indicating whether regression fit curves must be plotted </td></tr>
<tr valign="top"><td><code>dis</code></td>
<td>
regression design matrix </td></tr>
<tr valign="top"><td><code>step.method</code></td>
<td>
stepwise regression method to fit models for cluster mean profiles. Can be either <code>"backward"</code>, <code>"forward"</code>, <code>"two.ways.backward"</code> or <code>"two.ways.forward"</code> </td></tr>
<tr valign="top"><td><code>min.obs</code></td>
<td>
minimal number of observations for a gene to be included in the analysis</td></tr>
<tr valign="top"><td><code>alfa</code></td>
<td>
significance level used for variable selection in the stepwise regression </td></tr>
<tr valign="top"><td><code>show.lines</code></td>
<td>
logical indicating whether a line must be drawn joining plotted data points for reach group</td></tr>
<tr valign="top"><td><code>iter.max</code></td>
<td>
max. number of iteration when <code>cluster.method</code> = <code>"kmeans"</code> </td></tr>
<tr valign="top"><td><code>cexlab</code></td>
<td>
graphical parameter maginfication to be used for x labels in plotting functions </td></tr>
<tr valign="top"><td><code>legend</code></td>
<td>
logical indicating whether legend must be added when plotting profiles  </td></tr>
<tr valign="top"><td><code>main</code></td>
<td>
plot title </td></tr>
<tr valign="top"><td><code>ylim</code></td>
<td>
range of the y axis to be used by <code><a href="PlotProfiles.html">PlotProfiles</a></code> and <code><a href="PlotGroups.html">PlotGroups</a></code> </td></tr>
<tr valign="top"><td><code>newX11</code></td>
<td>
If <code>TRUE</code>, plot each type of plot in a diferent graphical device </td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
other graphical function argument </td></tr>
</table>

<h3>Details</h3>

<p>
Data can be provided either as a single data matrix of expression values, or a <code><a href="get.siggenes.html">get.siggenes</a></code> object. In the later case
the other argument of the fuction can be taken directly from <code>data</code>.
</p>
<p>
Data clustering can be done on the basis of either the original expression values, the regression coefficients, 
or the t.scores. In case <code>data</code> is a <code>get.siggenes</code> object, this is given by providing the element names of the list
<code>c("sig.profiles","coefficients","t.score")</code> of their list position (1,2 or 3).
</p>


<h3>Value</h3>

<p>
Experiment wide gene profiles and by group profiles plots are generated for each data cluster in the graphical device.
</p>
<table summary="R argblock">
<tr valign="top"><td><code>cut</code></td>
<td>
vector indicating gene partioning into clusters</td></tr>
<tr valign="top"><td><code>c.algo.used</code></td>
<td>
clustering algorith used for data partioning</td></tr>
<tr valign="top"><td><code>groups</code></td>
<td>
groups matrix used for plotting functions</td></tr>
</table>

<h3>Author(s)</h3>

<p>
Ana Conesa, aconesa@ivia.es; María José Nueda, mj.nueda@ua.es
</p>


<h3>References</h3>

<p>
Conesa, A., Nueda M.J., Alberto Ferrer, A., Talón, T. 2005.
maSigPro: a Method to Identify Significant Differential Expression Profiles in Time-Course Microarray Experiments.
</p>


<h3>See Also</h3>

<p>
<code><a href="PlotProfiles.html">PlotProfiles</a></code>, <code><a href="PlotGroups.html">PlotGroups</a></code>
</p>


<h3>Examples</h3>

<pre>

#### GENERATE TIME COURSE DATA
## generate n random gene expression profiles of a data set with 
## one control plus 3 treatments, 3 time points and r replicates per time point.

tc.GENE &lt;- function(n, r,
             var11 = 0.01, var12 = 0.01,var13 = 0.01,
             var21 = 0.01, var22 = 0.01, var23 =0.01,
             var31 = 0.01, var32 = 0.01, var33 = 0.01,
             var41 = 0.01, var42 = 0.01, var43 = 0.01,
             a1 = 0, a2 = 0, a3 = 0, a4 = 0,
             b1 = 0, b2 = 0, b3 = 0, b4 = 0,
             c1 = 0, c2 = 0, c3 = 0, c4 = 0)
{

  tc.dat &lt;- NULL
  for (i in 1:n) {
    Ctl &lt;- c(rnorm(r, a1, var11), rnorm(r, b1, var12), rnorm(r, c1, var13))  # Ctl group
    Tr1 &lt;- c(rnorm(r, a2, var21), rnorm(r, b2, var22), rnorm(r, c2, var23))  # Tr1 group
    Tr2 &lt;- c(rnorm(r, a3, var31), rnorm(r, b3, var32), rnorm(r, c3, var33))  # Tr2 group
    Tr3 &lt;- c(rnorm(r, a4, var41), rnorm(r, b4, var42), rnorm(r, c4, var43))  # Tr3 group
    gene &lt;- c(Ctl, Tr1, Tr2, Tr3)
    tc.dat &lt;- rbind(tc.dat, gene)
  }
  tc.dat
}

## Create 270 flat profiles
flat &lt;- tc.GENE(n = 270, r = 3)
## Create 10 genes with profile differences between Ctl and Tr1 groups
twodiff &lt;- tc.GENE (n = 10, r = 3, b2 = 0.5, c2 = 1.3)
## Create 10 genes with profile differences between Ctl, Tr2, and Tr3 groups
threediff &lt;- tc.GENE(n = 10, r = 3, b3 = 0.8, c3 = -1, a4 = -0.1, b4 = -0.8, c4 = -1.2)
## Create 10 genes with profile differences between Ctl and Tr2 and different variance
vardiff &lt;- tc.GENE(n = 10, r = 3, a3 = 0.7, b3 = 1, c3 = 1.2, var32 = 0.03, var33 = 0.03)
## Create dataset
tc.DATA &lt;- rbind(flat, twodiff, threediff, vardiff)
rownames(tc.DATA) &lt;- paste("feature", c(1:300), sep = "")
colnames(tc.DATA) &lt;- paste("Array", c(1:36), sep = "")
tc.DATA [sample(c(1:(300*36)), 300)] &lt;- NA  # introduce missing values

#### CREATE EXPERIMENTAL DESIGN
Time &lt;- rep(c(rep(c(1:3), each = 3)), 4)
Replicates &lt;- rep(c(1:12), each = 3)
Control &lt;- c(rep(1, 9), rep(0, 27))
Treat1 &lt;- c(rep(0, 9), rep(1, 9), rep(0, 18))
Treat2 &lt;- c(rep(0, 18), rep(1, 9), rep(0,9))
Treat3 &lt;- c(rep(0, 27), rep(1, 9))
edesign &lt;- cbind(Time, Replicates, Control, Treat1, Treat2, Treat3)
rownames(edesign) &lt;- paste("Array", c(1:36), sep = "")

see.genes(tc.DATA, edesign = edesign, k = 4, main = "Time Course")

# This will show the regression fit curve
dise &lt;- make.design.matrix(edesign)
see.genes(tc.DATA, edesign = edesign, k = 4, main = "Time Course", show.fit = TRUE, 
          dis = dise$dis, groups.vector = dise$groups.vector, distance = "euclidean")

</pre>



<hr><div align="center">[Package <em>maSigPro</em> version 1.0 <a href="00Index.html">Index]</a></div>

</body></html>
